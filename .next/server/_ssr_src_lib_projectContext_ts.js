"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
exports.id = "_ssr_src_lib_projectContext_ts";
exports.ids = ["_ssr_src_lib_projectContext_ts"];
exports.modules = {

/***/ "(ssr)/./src/lib/database.ts":
/*!*****************************!*\
  !*** ./src/lib/database.ts ***!
  \*****************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   DatabaseService: () => (/* binding */ DatabaseService),\n/* harmony export */   getDBService: () => (/* binding */ getDBService),\n/* harmony export */   initDB: () => (/* binding */ initDB)\n/* harmony export */ });\n/* harmony import */ var idb__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! idb */ \"(ssr)/./node_modules/idb/build/index.js\");\n/* harmony import */ var uuid__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! uuid */ \"(ssr)/./node_modules/uuid/dist/esm-node/v4.js\");\n\n\nconst DB_NAME = 'specgen';\nconst DB_VERSION = 1;\n// Database instance\nlet dbInstance = null;\n// Initialize database\nasync function initDB() {\n    if (dbInstance) return dbInstance;\n    dbInstance = await (0,idb__WEBPACK_IMPORTED_MODULE_0__.openDB)(DB_NAME, DB_VERSION, {\n        upgrade (db) {\n            // Projects store\n            const projectStore = db.createObjectStore('projects', {\n                keyPath: 'id'\n            });\n            projectStore.createIndex('by-created', 'created_at');\n            // Project contexts store\n            const contextStore = db.createObjectStore('project_contexts', {\n                keyPath: 'id'\n            });\n            contextStore.createIndex('by-project-active', [\n                'project_id',\n                'is_active'\n            ]);\n            contextStore.createIndex('by-project-created', [\n                'project_id',\n                'created_at'\n            ]);\n            // Project context diffs store\n            const diffStore = db.createObjectStore('project_context_diffs', {\n                keyPath: 'id'\n            });\n            diffStore.createIndex('by-context', 'project_context_id');\n            // Spec inputs store\n            const inputStore = db.createObjectStore('spec_inputs', {\n                keyPath: 'id'\n            });\n            inputStore.createIndex('by-project-created', [\n                'project_id',\n                'created_at'\n            ]);\n            // Spec outputs store\n            const outputStore = db.createObjectStore('spec_outputs', {\n                keyPath: 'id'\n            });\n            outputStore.createIndex('by-input', 'input_id');\n            outputStore.createIndex('by-created', 'created_at');\n            // Spec revisions store\n            const revisionStore = db.createObjectStore('spec_revisions', {\n                keyPath: 'id'\n            });\n            revisionStore.createIndex('by-output', 'output_id');\n            // Spec evaluations store\n            const evalStore = db.createObjectStore('spec_evaluations', {\n                keyPath: 'id'\n            });\n            evalStore.createIndex('by-output', 'output_id');\n        }\n    });\n    return dbInstance;\n}\n// Database operations\nclass DatabaseService {\n    constructor(db){\n        this.db = db;\n    }\n    // Projects\n    async createProject(data) {\n        const project = {\n            ...data,\n            id: (0,uuid__WEBPACK_IMPORTED_MODULE_1__[\"default\"])(),\n            created_at: new Date()\n        };\n        await this.db.add('projects', project);\n        return project;\n    }\n    async getProject(id) {\n        return this.db.get('projects', id);\n    }\n    async getProjects() {\n        return this.db.getAllFromIndex('projects', 'by-created');\n    }\n    async updateProject(id, updates) {\n        const project = await this.getProject(id);\n        if (!project) throw new Error('Project not found');\n        const updated = {\n            ...project,\n            ...updates\n        };\n        await this.db.put('projects', updated);\n    }\n    // Project Contexts\n    async createProjectContext(data) {\n        const context = {\n            ...data,\n            id: (0,uuid__WEBPACK_IMPORTED_MODULE_1__[\"default\"])(),\n            created_at: new Date()\n        };\n        // If this is active, deactivate others\n        if (context.is_active) {\n            await this.deactivateProjectContexts(context.project_id);\n        }\n        await this.db.add('project_contexts', context);\n        return context;\n    }\n    async getActiveProjectContext(projectId) {\n        const contexts = await this.db.getAllFromIndex('project_contexts', 'by-project-active', [\n            projectId,\n            1\n        ]);\n        return contexts[0];\n    }\n    async getProjectContexts(projectId) {\n        return this.db.getAllFromIndex('project_contexts', 'by-project-created', [\n            projectId\n        ]);\n    }\n    async activateProjectContext(contextId) {\n        const context = await this.db.get('project_contexts', contextId);\n        if (!context) throw new Error('Context not found');\n        // Deactivate others\n        await this.deactivateProjectContexts(context.project_id);\n        // Activate this one\n        context.is_active = 1;\n        await this.db.put('project_contexts', context);\n    }\n    async deactivateProjectContexts(projectId) {\n        const activeContexts = await this.db.getAllFromIndex('project_contexts', 'by-project-active', [\n            projectId,\n            1\n        ]);\n        for (const context of activeContexts){\n            context.is_active = 0;\n            await this.db.put('project_contexts', context);\n        }\n    }\n    // Spec Inputs\n    async createSpecInput(data) {\n        const input = {\n            ...data,\n            id: (0,uuid__WEBPACK_IMPORTED_MODULE_1__[\"default\"])(),\n            created_at: new Date()\n        };\n        await this.db.add('spec_inputs', input);\n        return input;\n    }\n    async getSpecInput(id) {\n        return this.db.get('spec_inputs', id);\n    }\n    async getSpecInputsByProject(projectId) {\n        return this.db.getAllFromIndex('spec_inputs', 'by-project-created', [\n            projectId\n        ]);\n    }\n    // Spec Outputs\n    async createSpecOutput(data) {\n        const output = {\n            ...data,\n            id: (0,uuid__WEBPACK_IMPORTED_MODULE_1__[\"default\"])(),\n            created_at: new Date()\n        };\n        await this.db.add('spec_outputs', output);\n        return output;\n    }\n    async getSpecOutput(id) {\n        return this.db.get('spec_outputs', id);\n    }\n    async getSpecOutputByInput(inputId) {\n        const outputs = await this.db.getAllFromIndex('spec_outputs', 'by-input', inputId);\n        return outputs[0] // Return latest\n        ;\n    }\n    async getRecentSpecOutputs(limit = 10) {\n        const outputs = await this.db.getAllFromIndex('spec_outputs', 'by-created');\n        return outputs.slice(-limit).reverse();\n    }\n    // Spec Evaluations\n    async createSpecEvaluation(data) {\n        const evaluation = {\n            ...data,\n            id: (0,uuid__WEBPACK_IMPORTED_MODULE_1__[\"default\"])(),\n            created_at: new Date()\n        };\n        await this.db.add('spec_evaluations', evaluation);\n        return evaluation;\n    }\n    async getSpecEvaluation(outputId) {\n        const evaluations = await this.db.getAllFromIndex('spec_evaluations', 'by-output', outputId);\n        return evaluations[0];\n    }\n}\n// Global database service instance\nlet dbService = null;\nasync function getDBService() {\n    if (!dbService) {\n        const db = await initDB();\n        dbService = new DatabaseService(db);\n    }\n    return dbService;\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QyxFQUFFLENBQUMsZ0JBQWdCOztJQUNwQztJQUVBLE1BQU1DLHFCQUFxQkMsUUFBUSxFQUFFLEVBQStCO1FBQ2xFLE1BQU1GLFVBQVUsTUFBTSxJQUFJLENBQUNqRCxFQUFFLENBQUNzQixlQUFlLENBQUMsZ0JBQWdCO1FBQzlELE9BQU8yQixRQUFRRyxLQUFLLENBQUMsQ0FBQ0QsT0FBT0UsT0FBTztJQUN0QztJQUVBLG1CQUFtQjtJQUNuQixNQUFNQyxxQkFBcUJ6QyxJQUErQyxFQUEyQjtRQUNuRyxNQUFNMEMsYUFBNkI7WUFDakMsR0FBRzFDLElBQUk7WUFDUEUsSUFBSXJCLGdEQUFNQTtZQUNWc0IsWUFBWSxJQUFJQztRQUNsQjtRQUNBLE1BQU0sSUFBSSxDQUFDakIsRUFBRSxDQUFDa0IsR0FBRyxDQUFDLG9CQUFvQnFDO1FBQ3RDLE9BQU9BO0lBQ1Q7SUFFQSxNQUFNQyxrQkFBa0JDLFFBQWdCLEVBQXVDO1FBQzdFLE1BQU1DLGNBQWMsTUFBTSxJQUFJLENBQUMxRCxFQUFFLENBQUNzQixlQUFlLENBQUMsb0JBQW9CLGFBQWFtQztRQUNuRixPQUFPQyxXQUFXLENBQUMsRUFBRTtJQUN2QjtBQUNGO0FBRUEsbUNBQW1DO0FBQ25DLElBQUlDLFlBQW9DO0FBRWpDLGVBQWVDO0lBQ3BCLElBQUksQ0FBQ0QsV0FBVztRQUNkLE1BQU0zRCxLQUFLLE1BQU1GO1FBQ2pCNkQsWUFBWSxJQUFJaEQsZ0JBQWdCWDtJQUNsQztJQUNBLE9BQU8yRDtBQUNUIiwic291cmNlcyI6WyIvVXNlcnMvamFzb25odWxiZXJ0L1Byb2plY3RzL3NwZWNnZW4vc3JjL2xpYi9kYXRhYmFzZS50cyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBvcGVuREIsIElEQlBEYXRhYmFzZSB9IGZyb20gJ2lkYidcbmltcG9ydCB7IHY0IGFzIHV1aWR2NCB9IGZyb20gJ3V1aWQnXG5pbXBvcnQge1xuICBQcm9qZWN0LFxuICBQcm9qZWN0Q29udGV4dCxcbiAgUHJvamVjdENvbnRleHREaWZmLFxuICBTcGVjSW5wdXRSZWNvcmQsXG4gIFNwZWNPdXRwdXRSZWNvcmQsXG4gIFNwZWNSZXZpc2lvbixcbiAgU3BlY0V2YWx1YXRpb24sXG59IGZyb20gJ0AvdHlwZXMvZGF0YWJhc2UnXG5cbmNvbnN0IERCX05BTUUgPSAnc3BlY2dlbidcbmNvbnN0IERCX1ZFUlNJT04gPSAxXG5cbi8vIERhdGFiYXNlIGludGVyZmFjZVxuaW50ZXJmYWNlIFNwZWNHZW5EQiB7XG4gIHByb2plY3RzOiB7XG4gICAga2V5OiBzdHJpbmdcbiAgICB2YWx1ZTogUHJvamVjdFxuICAgIGluZGV4ZXM6IHsgJ2J5LWNyZWF0ZWQnOiBEYXRlIH1cbiAgfVxuICBwcm9qZWN0X2NvbnRleHRzOiB7XG4gICAga2V5OiBzdHJpbmdcbiAgICB2YWx1ZTogUHJvamVjdENvbnRleHRcbiAgICBpbmRleGVzOiB7ICdieS1wcm9qZWN0LWFjdGl2ZSc6IFtzdHJpbmcsIG51bWJlcl07ICdieS1wcm9qZWN0LWNyZWF0ZWQnOiBbc3RyaW5nLCBEYXRlXSB9XG4gIH1cbiAgcHJvamVjdF9jb250ZXh0X2RpZmZzOiB7XG4gICAga2V5OiBzdHJpbmdcbiAgICB2YWx1ZTogUHJvamVjdENvbnRleHREaWZmXG4gICAgaW5kZXhlczogeyAnYnktY29udGV4dCc6IHN0cmluZyB9XG4gIH1cbiAgc3BlY19pbnB1dHM6IHtcbiAgICBrZXk6IHN0cmluZ1xuICAgIHZhbHVlOiBTcGVjSW5wdXRSZWNvcmRcbiAgICBpbmRleGVzOiB7ICdieS1wcm9qZWN0LWNyZWF0ZWQnOiBbc3RyaW5nLCBEYXRlXSB9XG4gIH1cbiAgc3BlY19vdXRwdXRzOiB7XG4gICAga2V5OiBzdHJpbmdcbiAgICB2YWx1ZTogU3BlY091dHB1dFJlY29yZFxuICAgIGluZGV4ZXM6IHsgJ2J5LWlucHV0Jzogc3RyaW5nOyAnYnktY3JlYXRlZCc6IERhdGUgfVxuICB9XG4gIHNwZWNfcmV2aXNpb25zOiB7XG4gICAga2V5OiBzdHJpbmdcbiAgICB2YWx1ZTogU3BlY1JldmlzaW9uXG4gICAgaW5kZXhlczogeyAnYnktb3V0cHV0Jzogc3RyaW5nIH1cbiAgfVxuICBzcGVjX2V2YWx1YXRpb25zOiB7XG4gICAga2V5OiBzdHJpbmdcbiAgICB2YWx1ZTogU3BlY0V2YWx1YXRpb25cbiAgICBpbmRleGVzOiB7ICdieS1vdXRwdXQnOiBzdHJpbmcgfVxuICB9XG59XG5cbi8vIERhdGFiYXNlIGluc3RhbmNlXG5sZXQgZGJJbnN0YW5jZTogSURCUERhdGFiYXNlPFNwZWNHZW5EQj4gfCBudWxsID0gbnVsbFxuXG4vLyBJbml0aWFsaXplIGRhdGFiYXNlXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gaW5pdERCKCk6IFByb21pc2U8SURCUERhdGFiYXNlPFNwZWNHZW5EQj4+IHtcbiAgaWYgKGRiSW5zdGFuY2UpIHJldHVybiBkYkluc3RhbmNlXG5cbiAgZGJJbnN0YW5jZSA9IGF3YWl0IG9wZW5EQjxTcGVjR2VuREI+KERCX05BTUUsIERCX1ZFUlNJT04sIHtcbiAgICB1cGdyYWRlKGRiKSB7XG4gICAgICAvLyBQcm9qZWN0cyBzdG9yZVxuICAgICAgY29uc3QgcHJvamVjdFN0b3JlID0gZGIuY3JlYXRlT2JqZWN0U3RvcmUoJ3Byb2plY3RzJywgeyBrZXlQYXRoOiAnaWQnIH0pXG4gICAgICBwcm9qZWN0U3RvcmUuY3JlYXRlSW5kZXgoJ2J5LWNyZWF0ZWQnLCAnY3JlYXRlZF9hdCcpXG5cbiAgICAgIC8vIFByb2plY3QgY29udGV4dHMgc3RvcmVcbiAgICAgIGNvbnN0IGNvbnRleHRTdG9yZSA9IGRiLmNyZWF0ZU9iamVjdFN0b3JlKCdwcm9qZWN0X2NvbnRleHRzJywgeyBrZXlQYXRoOiAnaWQnIH0pXG4gICAgICBjb250ZXh0U3RvcmUuY3JlYXRlSW5kZXgoJ2J5LXByb2plY3QtYWN0aXZlJywgWydwcm9qZWN0X2lkJywgJ2lzX2FjdGl2ZSddKVxuICAgICAgY29udGV4dFN0b3JlLmNyZWF0ZUluZGV4KCdieS1wcm9qZWN0LWNyZWF0ZWQnLCBbJ3Byb2plY3RfaWQnLCAnY3JlYXRlZF9hdCddKVxuXG4gICAgICAvLyBQcm9qZWN0IGNvbnRleHQgZGlmZnMgc3RvcmVcbiAgICAgIGNvbnN0IGRpZmZTdG9yZSA9IGRiLmNyZWF0ZU9iamVjdFN0b3JlKCdwcm9qZWN0X2NvbnRleHRfZGlmZnMnLCB7IGtleVBhdGg6ICdpZCcgfSlcbiAgICAgIGRpZmZTdG9yZS5jcmVhdGVJbmRleCgnYnktY29udGV4dCcsICdwcm9qZWN0X2NvbnRleHRfaWQnKVxuXG4gICAgICAvLyBTcGVjIGlucHV0cyBzdG9yZVxuICAgICAgY29uc3QgaW5wdXRTdG9yZSA9IGRiLmNyZWF0ZU9iamVjdFN0b3JlKCdzcGVjX2lucHV0cycsIHsga2V5UGF0aDogJ2lkJyB9KVxuICAgICAgaW5wdXRTdG9yZS5jcmVhdGVJbmRleCgnYnktcHJvamVjdC1jcmVhdGVkJywgWydwcm9qZWN0X2lkJywgJ2NyZWF0ZWRfYXQnXSlcblxuICAgICAgLy8gU3BlYyBvdXRwdXRzIHN0b3JlXG4gICAgICBjb25zdCBvdXRwdXRTdG9yZSA9IGRiLmNyZWF0ZU9iamVjdFN0b3JlKCdzcGVjX291dHB1dHMnLCB7IGtleVBhdGg6ICdpZCcgfSlcbiAgICAgIG91dHB1dFN0b3JlLmNyZWF0ZUluZGV4KCdieS1pbnB1dCcsICdpbnB1dF9pZCcpXG4gICAgICBvdXRwdXRTdG9yZS5jcmVhdGVJbmRleCgnYnktY3JlYXRlZCcsICdjcmVhdGVkX2F0JylcblxuICAgICAgLy8gU3BlYyByZXZpc2lvbnMgc3RvcmVcbiAgICAgIGNvbnN0IHJldmlzaW9uU3RvcmUgPSBkYi5jcmVhdGVPYmplY3RTdG9yZSgnc3BlY19yZXZpc2lvbnMnLCB7IGtleVBhdGg6ICdpZCcgfSlcbiAgICAgIHJldmlzaW9uU3RvcmUuY3JlYXRlSW5kZXgoJ2J5LW91dHB1dCcsICdvdXRwdXRfaWQnKVxuXG4gICAgICAvLyBTcGVjIGV2YWx1YXRpb25zIHN0b3JlXG4gICAgICBjb25zdCBldmFsU3RvcmUgPSBkYi5jcmVhdGVPYmplY3RTdG9yZSgnc3BlY19ldmFsdWF0aW9ucycsIHsga2V5UGF0aDogJ2lkJyB9KVxuICAgICAgZXZhbFN0b3JlLmNyZWF0ZUluZGV4KCdieS1vdXRwdXQnLCAnb3V0cHV0X2lkJylcbiAgICB9LFxuICB9KVxuXG4gIHJldHVybiBkYkluc3RhbmNlXG59XG5cbi8vIERhdGFiYXNlIG9wZXJhdGlvbnNcbmV4cG9ydCBjbGFzcyBEYXRhYmFzZVNlcnZpY2Uge1xuICBwcml2YXRlIGRiOiBJREJQRGF0YWJhc2U8U3BlY0dlbkRCPlxuXG4gIGNvbnN0cnVjdG9yKGRiOiBJREJQRGF0YWJhc2U8U3BlY0dlbkRCPikge1xuICAgIHRoaXMuZGIgPSBkYlxuICB9XG5cbiAgLy8gUHJvamVjdHNcbiAgYXN5bmMgY3JlYXRlUHJvamVjdChkYXRhOiBPbWl0PFByb2plY3QsICdpZCcgfCAnY3JlYXRlZF9hdCc+KTogUHJvbWlzZTxQcm9qZWN0PiB7XG4gICAgY29uc3QgcHJvamVjdDogUHJvamVjdCA9IHtcbiAgICAgIC4uLmRhdGEsXG4gICAgICBpZDogdXVpZHY0KCksXG4gICAgICBjcmVhdGVkX2F0OiBuZXcgRGF0ZSgpLFxuICAgIH1cbiAgICBhd2FpdCB0aGlzLmRiLmFkZCgncHJvamVjdHMnLCBwcm9qZWN0KVxuICAgIHJldHVybiBwcm9qZWN0XG4gIH1cblxuICBhc3luYyBnZXRQcm9qZWN0KGlkOiBzdHJpbmcpOiBQcm9taXNlPFByb2plY3QgfCB1bmRlZmluZWQ+IHtcbiAgICByZXR1cm4gdGhpcy5kYi5nZXQoJ3Byb2plY3RzJywgaWQpXG4gIH1cblxuICBhc3luYyBnZXRQcm9qZWN0cygpOiBQcm9taXNlPFByb2plY3RbXT4ge1xuICAgIHJldHVybiB0aGlzLmRiLmdldEFsbEZyb21JbmRleCgncHJvamVjdHMnLCAnYnktY3JlYXRlZCcpXG4gIH1cblxuICBhc3luYyB1cGRhdGVQcm9qZWN0KGlkOiBzdHJpbmcsIHVwZGF0ZXM6IFBhcnRpYWw8UHJvamVjdD4pOiBQcm9taXNlPHZvaWQ+IHtcbiAgICBjb25zdCBwcm9qZWN0ID0gYXdhaXQgdGhpcy5nZXRQcm9qZWN0KGlkKVxuICAgIGlmICghcHJvamVjdCkgdGhyb3cgbmV3IEVycm9yKCdQcm9qZWN0IG5vdCBmb3VuZCcpXG4gICAgXG4gICAgY29uc3QgdXBkYXRlZCA9IHsgLi4ucHJvamVjdCwgLi4udXBkYXRlcyB9XG4gICAgYXdhaXQgdGhpcy5kYi5wdXQoJ3Byb2plY3RzJywgdXBkYXRlZClcbiAgfVxuXG4gIC8vIFByb2plY3QgQ29udGV4dHNcbiAgYXN5bmMgY3JlYXRlUHJvamVjdENvbnRleHQoZGF0YTogT21pdDxQcm9qZWN0Q29udGV4dCwgJ2lkJyB8ICdjcmVhdGVkX2F0Jz4pOiBQcm9taXNlPFByb2plY3RDb250ZXh0PiB7XG4gICAgY29uc3QgY29udGV4dDogUHJvamVjdENvbnRleHQgPSB7XG4gICAgICAuLi5kYXRhLFxuICAgICAgaWQ6IHV1aWR2NCgpLFxuICAgICAgY3JlYXRlZF9hdDogbmV3IERhdGUoKSxcbiAgICB9XG4gICAgXG4gICAgLy8gSWYgdGhpcyBpcyBhY3RpdmUsIGRlYWN0aXZhdGUgb3RoZXJzXG4gICAgaWYgKGNvbnRleHQuaXNfYWN0aXZlKSB7XG4gICAgICBhd2FpdCB0aGlzLmRlYWN0aXZhdGVQcm9qZWN0Q29udGV4dHMoY29udGV4dC5wcm9qZWN0X2lkKVxuICAgIH1cbiAgICBcbiAgICBhd2FpdCB0aGlzLmRiLmFkZCgncHJvamVjdF9jb250ZXh0cycsIGNvbnRleHQpXG4gICAgcmV0dXJuIGNvbnRleHRcbiAgfVxuXG4gIGFzeW5jIGdldEFjdGl2ZVByb2plY3RDb250ZXh0KHByb2plY3RJZDogc3RyaW5nKTogUHJvbWlzZTxQcm9qZWN0Q29udGV4dCB8IHVuZGVmaW5lZD4ge1xuICAgIGNvbnN0IGNvbnRleHRzID0gYXdhaXQgdGhpcy5kYi5nZXRBbGxGcm9tSW5kZXgoJ3Byb2plY3RfY29udGV4dHMnLCAnYnktcHJvamVjdC1hY3RpdmUnLCBbcHJvamVjdElkLCAxXSlcbiAgICByZXR1cm4gY29udGV4dHNbMF1cbiAgfVxuXG4gIGFzeW5jIGdldFByb2plY3RDb250ZXh0cyhwcm9qZWN0SWQ6IHN0cmluZyk6IFByb21pc2U8UHJvamVjdENvbnRleHRbXT4ge1xuICAgIHJldHVybiB0aGlzLmRiLmdldEFsbEZyb21JbmRleCgncHJvamVjdF9jb250ZXh0cycsICdieS1wcm9qZWN0LWNyZWF0ZWQnLCBbcHJvamVjdElkXSlcbiAgfVxuXG4gIGFzeW5jIGFjdGl2YXRlUHJvamVjdENvbnRleHQoY29udGV4dElkOiBzdHJpbmcpOiBQcm9taXNlPHZvaWQ+IHtcbiAgICBjb25zdCBjb250ZXh0ID0gYXdhaXQgdGhpcy5kYi5nZXQoJ3Byb2plY3RfY29udGV4dHMnLCBjb250ZXh0SWQpXG4gICAgaWYgKCFjb250ZXh0KSB0aHJvdyBuZXcgRXJyb3IoJ0NvbnRleHQgbm90IGZvdW5kJylcbiAgICBcbiAgICAvLyBEZWFjdGl2YXRlIG90aGVyc1xuICAgIGF3YWl0IHRoaXMuZGVhY3RpdmF0ZVByb2plY3RDb250ZXh0cyhjb250ZXh0LnByb2plY3RfaWQpXG4gICAgXG4gICAgLy8gQWN0aXZhdGUgdGhpcyBvbmVcbiAgICBjb250ZXh0LmlzX2FjdGl2ZSA9IDFcbiAgICBhd2FpdCB0aGlzLmRiLnB1dCgncHJvamVjdF9jb250ZXh0cycsIGNvbnRleHQpXG4gIH1cblxuICBwcml2YXRlIGFzeW5jIGRlYWN0aXZhdGVQcm9qZWN0Q29udGV4dHMocHJvamVjdElkOiBzdHJpbmcpOiBQcm9taXNlPHZvaWQ+IHtcbiAgICBjb25zdCBhY3RpdmVDb250ZXh0cyA9IGF3YWl0IHRoaXMuZGIuZ2V0QWxsRnJvbUluZGV4KCdwcm9qZWN0X2NvbnRleHRzJywgJ2J5LXByb2plY3QtYWN0aXZlJywgW3Byb2plY3RJZCwgMV0pXG4gICAgXG4gICAgZm9yIChjb25zdCBjb250ZXh0IG9mIGFjdGl2ZUNvbnRleHRzKSB7XG4gICAgICBjb250ZXh0LmlzX2FjdGl2ZSA9IDBcbiAgICAgIGF3YWl0IHRoaXMuZGIucHV0KCdwcm9qZWN0X2NvbnRleHRzJywgY29udGV4dClcbiAgICB9XG4gIH1cblxuICAvLyBTcGVjIElucHV0c1xuICBhc3luYyBjcmVhdGVTcGVjSW5wdXQoZGF0YTogT21pdDxTcGVjSW5wdXRSZWNvcmQsICdpZCcgfCAnY3JlYXRlZF9hdCc+KTogUHJvbWlzZTxTcGVjSW5wdXRSZWNvcmQ+IHtcbiAgICBjb25zdCBpbnB1dDogU3BlY0lucHV0UmVjb3JkID0ge1xuICAgICAgLi4uZGF0YSxcbiAgICAgIGlkOiB1dWlkdjQoKSxcbiAgICAgIGNyZWF0ZWRfYXQ6IG5ldyBEYXRlKCksXG4gICAgfVxuICAgIGF3YWl0IHRoaXMuZGIuYWRkKCdzcGVjX2lucHV0cycsIGlucHV0KVxuICAgIHJldHVybiBpbnB1dFxuICB9XG5cbiAgYXN5bmMgZ2V0U3BlY0lucHV0KGlkOiBzdHJpbmcpOiBQcm9taXNlPFNwZWNJbnB1dFJlY29yZCB8IHVuZGVmaW5lZD4ge1xuICAgIHJldHVybiB0aGlzLmRiLmdldCgnc3BlY19pbnB1dHMnLCBpZClcbiAgfVxuXG4gIGFzeW5jIGdldFNwZWNJbnB1dHNCeVByb2plY3QocHJvamVjdElkOiBzdHJpbmcpOiBQcm9taXNlPFNwZWNJbnB1dFJlY29yZFtdPiB7XG4gICAgcmV0dXJuIHRoaXMuZGIuZ2V0QWxsRnJvbUluZGV4KCdzcGVjX2lucHV0cycsICdieS1wcm9qZWN0LWNyZWF0ZWQnLCBbcHJvamVjdElkXSlcbiAgfVxuXG4gIC8vIFNwZWMgT3V0cHV0c1xuICBhc3luYyBjcmVhdGVTcGVjT3V0cHV0KGRhdGE6IE9taXQ8U3BlY091dHB1dFJlY29yZCwgJ2lkJyB8ICdjcmVhdGVkX2F0Jz4pOiBQcm9taXNlPFNwZWNPdXRwdXRSZWNvcmQ+IHtcbiAgICBjb25zdCBvdXRwdXQ6IFNwZWNPdXRwdXRSZWNvcmQgPSB7XG4gICAgICAuLi5kYXRhLFxuICAgICAgaWQ6IHV1aWR2NCgpLFxuICAgICAgY3JlYXRlZF9hdDogbmV3IERhdGUoKSxcbiAgICB9XG4gICAgYXdhaXQgdGhpcy5kYi5hZGQoJ3NwZWNfb3V0cHV0cycsIG91dHB1dClcbiAgICByZXR1cm4gb3V0cHV0XG4gIH1cblxuICBhc3luYyBnZXRTcGVjT3V0cHV0KGlkOiBzdHJpbmcpOiBQcm9taXNlPFNwZWNPdXRwdXRSZWNvcmQgfCB1bmRlZmluZWQ+IHtcbiAgICByZXR1cm4gdGhpcy5kYi5nZXQoJ3NwZWNfb3V0cHV0cycsIGlkKVxuICB9XG5cbiAgYXN5bmMgZ2V0U3BlY091dHB1dEJ5SW5wdXQoaW5wdXRJZDogc3RyaW5nKTogUHJvbWlzZTxTcGVjT3V0cHV0UmVjb3JkIHwgdW5kZWZpbmVkPiB7XG4gICAgY29uc3Qgb3V0cHV0cyA9IGF3YWl0IHRoaXMuZGIuZ2V0QWxsRnJvbUluZGV4KCdzcGVjX291dHB1dHMnLCAnYnktaW5wdXQnLCBpbnB1dElkKVxuICAgIHJldHVybiBvdXRwdXRzWzBdIC8vIFJldHVybiBsYXRlc3RcbiAgfVxuXG4gIGFzeW5jIGdldFJlY2VudFNwZWNPdXRwdXRzKGxpbWl0ID0gMTApOiBQcm9taXNlPFNwZWNPdXRwdXRSZWNvcmRbXT4ge1xuICAgIGNvbnN0IG91dHB1dHMgPSBhd2FpdCB0aGlzLmRiLmdldEFsbEZyb21JbmRleCgnc3BlY19vdXRwdXRzJywgJ2J5LWNyZWF0ZWQnKVxuICAgIHJldHVybiBvdXRwdXRzLnNsaWNlKC1saW1pdCkucmV2ZXJzZSgpXG4gIH1cblxuICAvLyBTcGVjIEV2YWx1YXRpb25zXG4gIGFzeW5jIGNyZWF0ZVNwZWNFdmFsdWF0aW9uKGRhdGE6IE9taXQ8U3BlY0V2YWx1YXRpb24sICdpZCcgfCAnY3JlYXRlZF9hdCc+KTogUHJvbWlzZTxTcGVjRXZhbHVhdGlvbj4ge1xuICAgIGNvbnN0IGV2YWx1YXRpb246IFNwZWNFdmFsdWF0aW9uID0ge1xuICAgICAgLi4uZGF0YSxcbiAgICAgIGlkOiB1dWlkdjQoKSxcbiAgICAgIGNyZWF0ZWRfYXQ6IG5ldyBEYXRlKCksXG4gICAgfVxuICAgIGF3YWl0IHRoaXMuZGIuYWRkKCdzcGVjX2V2YWx1YXRpb25zJywgZXZhbHVhdGlvbilcbiAgICByZXR1cm4gZXZhbHVhdGlvblxuICB9XG5cbiAgYXN5bmMgZ2V0U3BlY0V2YWx1YXRpb24ob3V0cHV0SWQ6IHN0cmluZyk6IFByb21pc2U8U3BlY0V2YWx1YXRpb24gfCB1bmRlZmluZWQ+IHtcbiAgICBjb25zdCBldmFsdWF0aW9ucyA9IGF3YWl0IHRoaXMuZGIuZ2V0QWxsRnJvbUluZGV4KCdzcGVjX2V2YWx1YXRpb25zJywgJ2J5LW91dHB1dCcsIG91dHB1dElkKVxuICAgIHJldHVybiBldmFsdWF0aW9uc1swXVxuICB9XG59XG5cbi8vIEdsb2JhbCBkYXRhYmFzZSBzZXJ2aWNlIGluc3RhbmNlXG5sZXQgZGJTZXJ2aWNlOiBEYXRhYmFzZVNlcnZpY2UgfCBudWxsID0gbnVsbFxuXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZ2V0REJTZXJ2aWNlKCk6IFByb21pc2U8RGF0YWJhc2VTZXJ2aWNlPiB7XG4gIGlmICghZGJTZXJ2aWNlKSB7XG4gICAgY29uc3QgZGIgPSBhd2FpdCBpbml0REIoKVxuICAgIGRiU2VydmljZSA9IG5ldyBEYXRhYmFzZVNlcnZpY2UoZGIpXG4gIH1cbiAgcmV0dXJuIGRiU2VydmljZVxufSJdLCJuYW1lcyI6WyJvcGVuREIiLCJ2NCIsInV1aWR2NCIsIkRCX05BTUUiLCJEQl9WRVJTSU9OIiwiZGJJbnN0YW5jZSIsImluaXREQiIsInVwZ3JhZGUiLCJkYiIsInByb2plY3RTdG9yZSIsImNyZWF0ZU9iamVjdFN0b3JlIiwia2V5UGF0aCIsImNyZWF0ZUluZGV4IiwiY29udGV4dFN0b3JlIiwiZGlmZlN0b3JlIiwiaW5wdXRTdG9yZSIsIm91dHB1dFN0b3JlIiwicmV2aXNpb25TdG9yZSIsImV2YWxTdG9yZSIsIkRhdGFiYXNlU2VydmljZSIsImNyZWF0ZVByb2plY3QiLCJkYXRhIiwicHJvamVjdCIsImlkIiwiY3JlYXRlZF9hdCIsIkRhdGUiLCJhZGQiLCJnZXRQcm9qZWN0IiwiZ2V0IiwiZ2V0UHJvamVjdHMiLCJnZXRBbGxGcm9tSW5kZXgiLCJ1cGRhdGVQcm9qZWN0IiwidXBkYXRlcyIsIkVycm9yIiwidXBkYXRlZCIsInB1dCIsImNyZWF0ZVByb2plY3RDb250ZXh0IiwiY29udGV4dCIsImlzX2FjdGl2ZSIsImRlYWN0aXZhdGVQcm9qZWN0Q29udGV4dHMiLCJwcm9qZWN0X2lkIiwiZ2V0QWN0aXZlUHJvamVjdENvbnRleHQiLCJwcm9qZWN0SWQiLCJjb250ZXh0cyIsImdldFByb2plY3RDb250ZXh0cyIsImFjdGl2YXRlUHJvamVjdENvbnRleHQiLCJjb250ZXh0SWQiLCJhY3RpdmVDb250ZXh0cyIsImNyZWF0ZVNwZWNJbnB1dCIsImlucHV0IiwiZ2V0U3BlY0lucHV0IiwiZ2V0U3BlY0lucHV0c0J5UHJvamVjdCIsImNyZWF0ZVNwZWNPdXRwdXQiLCJvdXRwdXQiLCJnZXRTcGVjT3V0cHV0IiwiZ2V0U3BlY091dHB1dEJ5SW5wdXQiLCJpbnB1dElkIiwib3V0cHV0cyIsImdldFJlY2VudFNwZWNPdXRwdXRzIiwibGltaXQiLCJzbGljZSIsInJldmVyc2UiLCJjcmVhdGVTcGVjRXZhbHVhdGlvbiIsImV2YWx1YXRpb24iLCJnZXRTcGVjRXZhbHVhdGlvbiIsIm91dHB1dElkIiwiZXZhbHVhdGlvbnMiLCJkYlNlcnZpY2UiLCJnZXREQlNlcnZpY2UiXSwiaWdub3JlTGlzdCI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(ssr)/./src/lib/database.ts\n");

/***/ }),

/***/ "(ssr)/./src/lib/projectContext.ts":
/*!***********************************!*\
  !*** ./src/lib/projectContext.ts ***!
  \***********************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   DEFAULT_PROJECT_CONTEXT: () => (/* binding */ DEFAULT_PROJECT_CONTEXT),\n/* harmony export */   ProjectContextService: () => (/* binding */ ProjectContextService),\n/* harmony export */   projectContextService: () => (/* binding */ projectContextService)\n/* harmony export */ });\n/* harmony import */ var _lib_database__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @/lib/database */ \"(ssr)/./src/lib/database.ts\");\n\n// Deep merge utility for context merging\nfunction deepMerge(target, source) {\n    const result = {\n        ...target\n    };\n    for(const key in source){\n        if (source[key] !== undefined) {\n            if (Array.isArray(source[key])) {\n                result[key] = source[key];\n            } else if (typeof source[key] === 'object' && source[key] !== null && !Array.isArray(source[key])) {\n                result[key] = deepMerge(result[key] || {}, source[key]);\n            } else {\n                result[key] = source[key];\n            }\n        }\n    }\n    return result;\n}\n// Context difference calculation\nfunction calculateDiff(previous, current) {\n    const diff = {};\n    // Simple field-by-field comparison\n    for(const key in current){\n        if (JSON.stringify(previous[key]) !== JSON.stringify(current[key])) {\n            diff[key] = {\n                previous: previous[key],\n                current: current[key]\n            };\n        }\n    }\n    return diff;\n}\n// Default context template\nconst DEFAULT_PROJECT_CONTEXT = {\n    glossary: {},\n    stakeholders: [],\n    constraints: [],\n    non_functional: [],\n    api_catalog: [],\n    data_models: [],\n    envs: [\n        'local',\n        'dev',\n        'test',\n        'prod'\n    ],\n    labels: {}\n};\n// Context merging service\nclass ProjectContextService {\n    // Resolve final context by merging project defaults with feature overrides\n    async resolveContext(projectId, featureContext) {\n        const dbService = await (0,_lib_database__WEBPACK_IMPORTED_MODULE_0__.getDBService)();\n        // Get active project context (defaults)\n        const activeContext = await dbService.getActiveProjectContext(projectId);\n        const projectDefaults = activeContext?.context_json || DEFAULT_PROJECT_CONTEXT;\n        // If no feature context or inherit_from_project is false, return project defaults\n        if (!featureContext || !featureContext.inherit_from_project) {\n            return projectDefaults;\n        }\n        // Merge project defaults with feature overrides\n        let resolvedContext = {\n            ...projectDefaults\n        };\n        // Apply feature-level context fields\n        if (featureContext.stakeholders?.length) {\n            const existingStakeholders = resolvedContext.stakeholders.map((s)=>s.name);\n            const newStakeholderNames = featureContext.stakeholders.filter((name)=>!existingStakeholders.includes(name));\n            // Add new stakeholders with basic info\n            const newStakeholders = newStakeholderNames.map((name)=>({\n                    name,\n                    role: 'Stakeholder',\n                    interests: []\n                }));\n            resolvedContext.stakeholders = [\n                ...resolvedContext.stakeholders,\n                ...newStakeholders\n            ];\n        }\n        if (featureContext.constraints?.length) {\n            const uniqueConstraints = new Set([\n                ...resolvedContext.constraints,\n                ...featureContext.constraints\n            ]);\n            resolvedContext.constraints = Array.from(uniqueConstraints);\n        }\n        if (featureContext.non_functional?.length) {\n            const uniqueNonFunctional = new Set([\n                ...resolvedContext.non_functional,\n                ...featureContext.non_functional\n            ]);\n            resolvedContext.non_functional = Array.from(uniqueNonFunctional);\n        }\n        // Apply explicit overrides (feature overrides always win)\n        if (featureContext.overrides) {\n            resolvedContext = deepMerge(resolvedContext, featureContext.overrides);\n        }\n        return resolvedContext;\n    }\n    // Create a new project context version\n    async createProjectContext(projectId, context, isActive = false) {\n        const dbService = await (0,_lib_database__WEBPACK_IMPORTED_MODULE_0__.getDBService)();\n        // Get current version number\n        const existingContexts = await dbService.getProjectContexts(projectId);\n        const nextVersion = existingContexts.length > 0 ? Math.max(...existingContexts.map((c)=>c.version)) + 1 : 1;\n        // Create new context\n        const newContext = await dbService.createProjectContext({\n            project_id: projectId,\n            context_json: context,\n            version: nextVersion,\n            is_active: isActive ? 1 : 0\n        });\n        // Create diff if there's a previous version\n        if (existingContexts.length > 0) {\n            const previousContext = existingContexts[existingContexts.length - 1];\n            const diff = calculateDiff(previousContext.context_json, context);\n            if (Object.keys(diff).length > 0) {\n            // Store the diff (if needed for history tracking)\n            // await dbService.createProjectContextDiff(...) \n            }\n        }\n        return newContext;\n    }\n    // Update and version a project context\n    async updateProjectContext(projectId, updates, createNewVersion = true) {\n        const dbService = await (0,_lib_database__WEBPACK_IMPORTED_MODULE_0__.getDBService)();\n        // Get current active context\n        const activeContext = await dbService.getActiveProjectContext(projectId);\n        if (!activeContext) {\n            throw new Error('No active context found for project');\n        }\n        // Merge updates\n        const updatedContext = deepMerge(activeContext.context_json, updates);\n        if (createNewVersion) {\n            // Create new version\n            return this.createProjectContext(projectId, updatedContext, true);\n        } else {\n            // Update in place (rare case)\n            activeContext.context_json = updatedContext;\n            await dbService.updateProject(activeContext.id, activeContext);\n            return activeContext;\n        }\n    }\n    // Get context history with diffs\n    async getContextHistory(projectId) {\n        const dbService = await (0,_lib_database__WEBPACK_IMPORTED_MODULE_0__.getDBService)();\n        const contexts = await dbService.getProjectContexts(projectId);\n        // Sort by version\n        contexts.sort((a, b)=>a.version - b.version);\n        // Calculate diffs between versions\n        const history = contexts.map((context, index)=>{\n            let diff = {};\n            if (index > 0) {\n                diff = calculateDiff(contexts[index - 1].context_json, context.context_json);\n            }\n            return {\n                ...context,\n                diff,\n                is_current: context.is_active === 1\n            };\n        });\n        return history;\n    }\n    // Activate a specific context version\n    async activateContextVersion(contextId) {\n        const dbService = await (0,_lib_database__WEBPACK_IMPORTED_MODULE_0__.getDBService)();\n        await dbService.activateProjectContext(contextId);\n    }\n    // Preview resolved context without saving\n    async previewResolvedContext(projectId, featureContext) {\n        const dbService = await (0,_lib_database__WEBPACK_IMPORTED_MODULE_0__.getDBService)();\n        const activeContext = await dbService.getActiveProjectContext(projectId);\n        const projectDefaults = activeContext?.context_json || DEFAULT_PROJECT_CONTEXT;\n        const resolved = await this.resolveContext(projectId, featureContext);\n        // Calculate what came from where for transparency\n        const inherited = {\n            ...projectDefaults\n        };\n        const overrides = featureContext.overrides || {};\n        return {\n            resolved,\n            inherited_from_project: inherited,\n            feature_overrides: overrides\n        };\n    }\n    // Validate context completeness\n    validateContext(context) {\n        const warnings = [];\n        const suggestions = [];\n        // Check for common missing elements\n        if (Object.keys(context.glossary).length === 0) {\n            suggestions.push('Consider adding domain terms to the glossary');\n        }\n        if (context.stakeholders.length === 0) {\n            warnings.push('No stakeholders defined - this may lead to unclear requirements');\n        }\n        if (context.constraints.length === 0) {\n            suggestions.push('Consider adding technical or business constraints');\n        }\n        if (context.non_functional.length === 0) {\n            suggestions.push('Consider adding non-functional requirements (performance, security, etc.)');\n        }\n        if (context.api_catalog.length === 0) {\n            suggestions.push('Consider documenting existing APIs and services');\n        }\n        // Check stakeholder completeness\n        const incompleteStakeholders = context.stakeholders.filter((s)=>!s.role || s.interests.length === 0);\n        if (incompleteStakeholders.length > 0) {\n            warnings.push(`${incompleteStakeholders.length} stakeholder(s) missing role or interests`);\n        }\n        const isValid = warnings.length === 0;\n        return {\n            isValid,\n            warnings,\n            suggestions\n        };\n    }\n    // Import context from external source (Jira, Confluence, etc.)\n    async importContext(projectId, source, data) {\n        // Placeholder for external integrations\n        switch(source){\n            case 'json':\n                // Validate and import JSON context\n                const imported = data;\n                return this.createProjectContext(projectId, imported, false).then((c)=>c.context_json);\n            case 'jira':\n                // Extract context from Jira project metadata\n                // This would integrate with Jira API to extract components, users, etc.\n                throw new Error('Jira import not yet implemented');\n            case 'confluence':\n                // Extract context from Confluence space\n                throw new Error('Confluence import not yet implemented');\n            default:\n                throw new Error(`Unknown import source: ${source}`);\n        }\n    }\n}\n// Default service instance\nconst projectContextService = new ProjectContextService();\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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T0MsSUFBSSxDQUFDeEMsQ0FBQUEsSUFBS0EsRUFBRTNCLFlBQVk7WUFFdkYsS0FBSztnQkFDSCw2Q0FBNkM7Z0JBQzdDLHdFQUF3RTtnQkFDeEUsTUFBTSxJQUFJc0MsTUFBTTtZQUVsQixLQUFLO2dCQUNILHdDQUF3QztnQkFDeEMsTUFBTSxJQUFJQSxNQUFNO1lBRWxCO2dCQUNFLE1BQU0sSUFBSUEsTUFBTSxDQUFDLHVCQUF1QixFQUFFbkUsUUFBUTtRQUN0RDtJQUNGO0FBQ0Y7QUFFQSwyQkFBMkI7QUFDcEIsTUFBTWlHLHdCQUF3QixJQUFJNUUsd0JBQXVCIiwic291cmNlcyI6WyIvVXNlcnMvamFzb25odWxiZXJ0L1Byb2plY3RzL3NwZWNnZW4vc3JjL2xpYi9wcm9qZWN0Q29udGV4dC50cyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBSZXNvbHZlZENvbnRleHQsIFNwZWNJbnB1dCwgSW5wdXRDb250ZXh0IH0gZnJvbSAnQC90eXBlcy9zY2hlbWFzJ1xuaW1wb3J0IHsgZ2V0REJTZXJ2aWNlIH0gZnJvbSAnQC9saWIvZGF0YWJhc2UnXG5cbi8vIERlZXAgbWVyZ2UgdXRpbGl0eSBmb3IgY29udGV4dCBtZXJnaW5nXG5mdW5jdGlvbiBkZWVwTWVyZ2U8VCBleHRlbmRzIFJlY29yZDxzdHJpbmcsIGFueT4+KHRhcmdldDogVCwgc291cmNlOiBQYXJ0aWFsPFQ+KTogVCB7XG4gIGNvbnN0IHJlc3VsdCA9IHsgLi4udGFyZ2V0IH1cbiAgXG4gIGZvciAoY29uc3Qga2V5IGluIHNvdXJjZSkge1xuICAgIGlmIChzb3VyY2Vba2V5XSAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICBpZiAoQXJyYXkuaXNBcnJheShzb3VyY2Vba2V5XSkpIHtcbiAgICAgICAgcmVzdWx0W2tleV0gPSBzb3VyY2Vba2V5XSBhcyBUW0V4dHJhY3Q8a2V5b2YgVCwgc3RyaW5nPl1cbiAgICAgIH0gZWxzZSBpZiAodHlwZW9mIHNvdXJjZVtrZXldID09PSAnb2JqZWN0JyAmJiBzb3VyY2Vba2V5XSAhPT0gbnVsbCAmJiAhQXJyYXkuaXNBcnJheShzb3VyY2Vba2V5XSkpIHtcbiAgICAgICAgcmVzdWx0W2tleV0gPSBkZWVwTWVyZ2UocmVzdWx0W2tleV0gfHwge30sIHNvdXJjZVtrZXldKSBhcyBUW0V4dHJhY3Q8a2V5b2YgVCwgc3RyaW5nPl1cbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHJlc3VsdFtrZXldID0gc291cmNlW2tleV0gYXMgVFtFeHRyYWN0PGtleW9mIFQsIHN0cmluZz5dXG4gICAgICB9XG4gICAgfVxuICB9XG4gIFxuICByZXR1cm4gcmVzdWx0XG59XG5cbi8vIENvbnRleHQgZGlmZmVyZW5jZSBjYWxjdWxhdGlvblxuZnVuY3Rpb24gY2FsY3VsYXRlRGlmZihwcmV2aW91czogUmVzb2x2ZWRDb250ZXh0LCBjdXJyZW50OiBSZXNvbHZlZENvbnRleHQpOiBSZWNvcmQ8c3RyaW5nLCBhbnk+IHtcbiAgY29uc3QgZGlmZjogUmVjb3JkPHN0cmluZywgYW55PiA9IHt9XG4gIFxuICAvLyBTaW1wbGUgZmllbGQtYnktZmllbGQgY29tcGFyaXNvblxuICBmb3IgKGNvbnN0IGtleSBpbiBjdXJyZW50KSB7XG4gICAgaWYgKEpTT04uc3RyaW5naWZ5KHByZXZpb3VzW2tleSBhcyBrZXlvZiBSZXNvbHZlZENvbnRleHRdKSAhPT0gSlNPTi5zdHJpbmdpZnkoY3VycmVudFtrZXkgYXMga2V5b2YgUmVzb2x2ZWRDb250ZXh0XSkpIHtcbiAgICAgIGRpZmZba2V5XSA9IHtcbiAgICAgICAgcHJldmlvdXM6IHByZXZpb3VzW2tleSBhcyBrZXlvZiBSZXNvbHZlZENvbnRleHRdLFxuICAgICAgICBjdXJyZW50OiBjdXJyZW50W2tleSBhcyBrZXlvZiBSZXNvbHZlZENvbnRleHRdLFxuICAgICAgfVxuICAgIH1cbiAgfVxuICBcbiAgcmV0dXJuIGRpZmZcbn1cblxuLy8gRGVmYXVsdCBjb250ZXh0IHRlbXBsYXRlXG5leHBvcnQgY29uc3QgREVGQVVMVF9QUk9KRUNUX0NPTlRFWFQ6IFJlc29sdmVkQ29udGV4dCA9IHtcbiAgZ2xvc3Nhcnk6IHt9LFxuICBzdGFrZWhvbGRlcnM6IFtdLFxuICBjb25zdHJhaW50czogW10sXG4gIG5vbl9mdW5jdGlvbmFsOiBbXSxcbiAgYXBpX2NhdGFsb2c6IFtdLFxuICBkYXRhX21vZGVsczogW10sXG4gIGVudnM6IFsnbG9jYWwnLCAnZGV2JywgJ3Rlc3QnLCAncHJvZCddLFxuICBsYWJlbHM6IHt9LFxufVxuXG4vLyBDb250ZXh0IG1lcmdpbmcgc2VydmljZVxuZXhwb3J0IGNsYXNzIFByb2plY3RDb250ZXh0U2VydmljZSB7XG4gIFxuICAvLyBSZXNvbHZlIGZpbmFsIGNvbnRleHQgYnkgbWVyZ2luZyBwcm9qZWN0IGRlZmF1bHRzIHdpdGggZmVhdHVyZSBvdmVycmlkZXNcbiAgYXN5bmMgcmVzb2x2ZUNvbnRleHQocHJvamVjdElkOiBzdHJpbmcsIGZlYXR1cmVDb250ZXh0PzogSW5wdXRDb250ZXh0KTogUHJvbWlzZTxSZXNvbHZlZENvbnRleHQ+IHtcbiAgICBjb25zdCBkYlNlcnZpY2UgPSBhd2FpdCBnZXREQlNlcnZpY2UoKVxuICAgIFxuICAgIC8vIEdldCBhY3RpdmUgcHJvamVjdCBjb250ZXh0IChkZWZhdWx0cylcbiAgICBjb25zdCBhY3RpdmVDb250ZXh0ID0gYXdhaXQgZGJTZXJ2aWNlLmdldEFjdGl2ZVByb2plY3RDb250ZXh0KHByb2plY3RJZClcbiAgICBjb25zdCBwcm9qZWN0RGVmYXVsdHMgPSBhY3RpdmVDb250ZXh0Py5jb250ZXh0X2pzb24gfHwgREVGQVVMVF9QUk9KRUNUX0NPTlRFWFRcbiAgICBcbiAgICAvLyBJZiBubyBmZWF0dXJlIGNvbnRleHQgb3IgaW5oZXJpdF9mcm9tX3Byb2plY3QgaXMgZmFsc2UsIHJldHVybiBwcm9qZWN0IGRlZmF1bHRzXG4gICAgaWYgKCFmZWF0dXJlQ29udGV4dCB8fCAhZmVhdHVyZUNvbnRleHQuaW5oZXJpdF9mcm9tX3Byb2plY3QpIHtcbiAgICAgIHJldHVybiBwcm9qZWN0RGVmYXVsdHNcbiAgICB9XG4gICAgXG4gICAgLy8gTWVyZ2UgcHJvamVjdCBkZWZhdWx0cyB3aXRoIGZlYXR1cmUgb3ZlcnJpZGVzXG4gICAgbGV0IHJlc29sdmVkQ29udGV4dCA9IHsgLi4ucHJvamVjdERlZmF1bHRzIH1cbiAgICBcbiAgICAvLyBBcHBseSBmZWF0dXJlLWxldmVsIGNvbnRleHQgZmllbGRzXG4gICAgaWYgKGZlYXR1cmVDb250ZXh0LnN0YWtlaG9sZGVycz8ubGVuZ3RoKSB7XG4gICAgICBjb25zdCBleGlzdGluZ1N0YWtlaG9sZGVycyA9IHJlc29sdmVkQ29udGV4dC5zdGFrZWhvbGRlcnMubWFwKHMgPT4gcy5uYW1lKVxuICAgICAgY29uc3QgbmV3U3Rha2Vob2xkZXJOYW1lcyA9IGZlYXR1cmVDb250ZXh0LnN0YWtlaG9sZGVycy5maWx0ZXIobmFtZSA9PiAhZXhpc3RpbmdTdGFrZWhvbGRlcnMuaW5jbHVkZXMobmFtZSkpXG4gICAgICBcbiAgICAgIC8vIEFkZCBuZXcgc3Rha2Vob2xkZXJzIHdpdGggYmFzaWMgaW5mb1xuICAgICAgY29uc3QgbmV3U3Rha2Vob2xkZXJzID0gbmV3U3Rha2Vob2xkZXJOYW1lcy5tYXAobmFtZSA9PiAoe1xuICAgICAgICBuYW1lLFxuICAgICAgICByb2xlOiAnU3Rha2Vob2xkZXInLFxuICAgICAgICBpbnRlcmVzdHM6IFtdLFxuICAgICAgfSkpXG4gICAgICBcbiAgICAgIHJlc29sdmVkQ29udGV4dC5zdGFrZWhvbGRlcnMgPSBbLi4ucmVzb2x2ZWRDb250ZXh0LnN0YWtlaG9sZGVycywgLi4ubmV3U3Rha2Vob2xkZXJzXVxuICAgIH1cbiAgICBcbiAgICBpZiAoZmVhdHVyZUNvbnRleHQuY29uc3RyYWludHM/Lmxlbmd0aCkge1xuICAgICAgY29uc3QgdW5pcXVlQ29uc3RyYWludHMgPSBuZXcgU2V0KFsuLi5yZXNvbHZlZENvbnRleHQuY29uc3RyYWludHMsIC4uLmZlYXR1cmVDb250ZXh0LmNvbnN0cmFpbnRzXSlcbiAgICAgIHJlc29sdmVkQ29udGV4dC5jb25zdHJhaW50cyA9IEFycmF5LmZyb20odW5pcXVlQ29uc3RyYWludHMpXG4gICAgfVxuICAgIFxuICAgIGlmIChmZWF0dXJlQ29udGV4dC5ub25fZnVuY3Rpb25hbD8ubGVuZ3RoKSB7XG4gICAgICBjb25zdCB1bmlxdWVOb25GdW5jdGlvbmFsID0gbmV3IFNldChbLi4ucmVzb2x2ZWRDb250ZXh0Lm5vbl9mdW5jdGlvbmFsLCAuLi5mZWF0dXJlQ29udGV4dC5ub25fZnVuY3Rpb25hbF0pXG4gICAgICByZXNvbHZlZENvbnRleHQubm9uX2Z1bmN0aW9uYWwgPSBBcnJheS5mcm9tKHVuaXF1ZU5vbkZ1bmN0aW9uYWwpXG4gICAgfVxuICAgIFxuICAgIC8vIEFwcGx5IGV4cGxpY2l0IG92ZXJyaWRlcyAoZmVhdHVyZSBvdmVycmlkZXMgYWx3YXlzIHdpbilcbiAgICBpZiAoZmVhdHVyZUNvbnRleHQub3ZlcnJpZGVzKSB7XG4gICAgICByZXNvbHZlZENvbnRleHQgPSBkZWVwTWVyZ2UocmVzb2x2ZWRDb250ZXh0LCBmZWF0dXJlQ29udGV4dC5vdmVycmlkZXMgYXMgUGFydGlhbDxSZXNvbHZlZENvbnRleHQ+KVxuICAgIH1cbiAgICBcbiAgICByZXR1cm4gcmVzb2x2ZWRDb250ZXh0XG4gIH1cbiAgXG4gIC8vIENyZWF0ZSBhIG5ldyBwcm9qZWN0IGNvbnRleHQgdmVyc2lvblxuICBhc3luYyBjcmVhdGVQcm9qZWN0Q29udGV4dChcbiAgICBwcm9qZWN0SWQ6IHN0cmluZywgXG4gICAgY29udGV4dDogUmVzb2x2ZWRDb250ZXh0LCBcbiAgICBpc0FjdGl2ZTogYm9vbGVhbiA9IGZhbHNlXG4gICkge1xuICAgIGNvbnN0IGRiU2VydmljZSA9IGF3YWl0IGdldERCU2VydmljZSgpXG4gICAgXG4gICAgLy8gR2V0IGN1cnJlbnQgdmVyc2lvbiBudW1iZXJcbiAgICBjb25zdCBleGlzdGluZ0NvbnRleHRzID0gYXdhaXQgZGJTZXJ2aWNlLmdldFByb2plY3RDb250ZXh0cyhwcm9qZWN0SWQpXG4gICAgY29uc3QgbmV4dFZlcnNpb24gPSBleGlzdGluZ0NvbnRleHRzLmxlbmd0aCA+IDAgXG4gICAgICA/IE1hdGgubWF4KC4uLmV4aXN0aW5nQ29udGV4dHMubWFwKGMgPT4gYy52ZXJzaW9uKSkgKyAxIFxuICAgICAgOiAxXG4gICAgXG4gICAgLy8gQ3JlYXRlIG5ldyBjb250ZXh0XG4gICAgY29uc3QgbmV3Q29udGV4dCA9IGF3YWl0IGRiU2VydmljZS5jcmVhdGVQcm9qZWN0Q29udGV4dCh7XG4gICAgICBwcm9qZWN0X2lkOiBwcm9qZWN0SWQsXG4gICAgICBjb250ZXh0X2pzb246IGNvbnRleHQsXG4gICAgICB2ZXJzaW9uOiBuZXh0VmVyc2lvbixcbiAgICAgIGlzX2FjdGl2ZTogaXNBY3RpdmUgPyAxIDogMCxcbiAgICB9KVxuICAgIFxuICAgIC8vIENyZWF0ZSBkaWZmIGlmIHRoZXJlJ3MgYSBwcmV2aW91cyB2ZXJzaW9uXG4gICAgaWYgKGV4aXN0aW5nQ29udGV4dHMubGVuZ3RoID4gMCkge1xuICAgICAgY29uc3QgcHJldmlvdXNDb250ZXh0ID0gZXhpc3RpbmdDb250ZXh0c1tleGlzdGluZ0NvbnRleHRzLmxlbmd0aCAtIDFdXG4gICAgICBjb25zdCBkaWZmID0gY2FsY3VsYXRlRGlmZihwcmV2aW91c0NvbnRleHQuY29udGV4dF9qc29uLCBjb250ZXh0KVxuICAgICAgXG4gICAgICBpZiAoT2JqZWN0LmtleXMoZGlmZikubGVuZ3RoID4gMCkge1xuICAgICAgICAvLyBTdG9yZSB0aGUgZGlmZiAoaWYgbmVlZGVkIGZvciBoaXN0b3J5IHRyYWNraW5nKVxuICAgICAgICAvLyBhd2FpdCBkYlNlcnZpY2UuY3JlYXRlUHJvamVjdENvbnRleHREaWZmKC4uLikgXG4gICAgICB9XG4gICAgfVxuICAgIFxuICAgIHJldHVybiBuZXdDb250ZXh0XG4gIH1cbiAgXG4gIC8vIFVwZGF0ZSBhbmQgdmVyc2lvbiBhIHByb2plY3QgY29udGV4dFxuICBhc3luYyB1cGRhdGVQcm9qZWN0Q29udGV4dChcbiAgICBwcm9qZWN0SWQ6IHN0cmluZyxcbiAgICB1cGRhdGVzOiBQYXJ0aWFsPFJlc29sdmVkQ29udGV4dD4sXG4gICAgY3JlYXRlTmV3VmVyc2lvbjogYm9vbGVhbiA9IHRydWVcbiAgKSB7XG4gICAgY29uc3QgZGJTZXJ2aWNlID0gYXdhaXQgZ2V0REJTZXJ2aWNlKClcbiAgICBcbiAgICAvLyBHZXQgY3VycmVudCBhY3RpdmUgY29udGV4dFxuICAgIGNvbnN0IGFjdGl2ZUNvbnRleHQgPSBhd2FpdCBkYlNlcnZpY2UuZ2V0QWN0aXZlUHJvamVjdENvbnRleHQocHJvamVjdElkKVxuICAgIGlmICghYWN0aXZlQ29udGV4dCkge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKCdObyBhY3RpdmUgY29udGV4dCBmb3VuZCBmb3IgcHJvamVjdCcpXG4gICAgfVxuICAgIFxuICAgIC8vIE1lcmdlIHVwZGF0ZXNcbiAgICBjb25zdCB1cGRhdGVkQ29udGV4dCA9IGRlZXBNZXJnZShhY3RpdmVDb250ZXh0LmNvbnRleHRfanNvbiwgdXBkYXRlcylcbiAgICBcbiAgICBpZiAoY3JlYXRlTmV3VmVyc2lvbikge1xuICAgICAgLy8gQ3JlYXRlIG5ldyB2ZXJzaW9uXG4gICAgICByZXR1cm4gdGhpcy5jcmVhdGVQcm9qZWN0Q29udGV4dChwcm9qZWN0SWQsIHVwZGF0ZWRDb250ZXh0LCB0cnVlKVxuICAgIH0gZWxzZSB7XG4gICAgICAvLyBVcGRhdGUgaW4gcGxhY2UgKHJhcmUgY2FzZSlcbiAgICAgIGFjdGl2ZUNvbnRleHQuY29udGV4dF9qc29uID0gdXBkYXRlZENvbnRleHRcbiAgICAgIGF3YWl0IGRiU2VydmljZS51cGRhdGVQcm9qZWN0KGFjdGl2ZUNvbnRleHQuaWQsIGFjdGl2ZUNvbnRleHQgYXMgYW55KVxuICAgICAgcmV0dXJuIGFjdGl2ZUNvbnRleHRcbiAgICB9XG4gIH1cbiAgXG4gIC8vIEdldCBjb250ZXh0IGhpc3Rvcnkgd2l0aCBkaWZmc1xuICBhc3luYyBnZXRDb250ZXh0SGlzdG9yeShwcm9qZWN0SWQ6IHN0cmluZykge1xuICAgIGNvbnN0IGRiU2VydmljZSA9IGF3YWl0IGdldERCU2VydmljZSgpXG4gICAgY29uc3QgY29udGV4dHMgPSBhd2FpdCBkYlNlcnZpY2UuZ2V0UHJvamVjdENvbnRleHRzKHByb2plY3RJZClcbiAgICBcbiAgICAvLyBTb3J0IGJ5IHZlcnNpb25cbiAgICBjb250ZXh0cy5zb3J0KChhLCBiKSA9PiBhLnZlcnNpb24gLSBiLnZlcnNpb24pXG4gICAgXG4gICAgLy8gQ2FsY3VsYXRlIGRpZmZzIGJldHdlZW4gdmVyc2lvbnNcbiAgICBjb25zdCBoaXN0b3J5ID0gY29udGV4dHMubWFwKChjb250ZXh0LCBpbmRleCkgPT4ge1xuICAgICAgbGV0IGRpZmYgPSB7fVxuICAgICAgaWYgKGluZGV4ID4gMCkge1xuICAgICAgICBkaWZmID0gY2FsY3VsYXRlRGlmZihjb250ZXh0c1tpbmRleCAtIDFdLmNvbnRleHRfanNvbiwgY29udGV4dC5jb250ZXh0X2pzb24pXG4gICAgICB9XG4gICAgICBcbiAgICAgIHJldHVybiB7XG4gICAgICAgIC4uLmNvbnRleHQsXG4gICAgICAgIGRpZmYsXG4gICAgICAgIGlzX2N1cnJlbnQ6IGNvbnRleHQuaXNfYWN0aXZlID09PSAxLFxuICAgICAgfVxuICAgIH0pXG4gICAgXG4gICAgcmV0dXJuIGhpc3RvcnlcbiAgfVxuICBcbiAgLy8gQWN0aXZhdGUgYSBzcGVjaWZpYyBjb250ZXh0IHZlcnNpb25cbiAgYXN5bmMgYWN0aXZhdGVDb250ZXh0VmVyc2lvbihjb250ZXh0SWQ6IHN0cmluZykge1xuICAgIGNvbnN0IGRiU2VydmljZSA9IGF3YWl0IGdldERCU2VydmljZSgpXG4gICAgYXdhaXQgZGJTZXJ2aWNlLmFjdGl2YXRlUHJvamVjdENvbnRleHQoY29udGV4dElkKVxuICB9XG4gIFxuICAvLyBQcmV2aWV3IHJlc29sdmVkIGNvbnRleHQgd2l0aG91dCBzYXZpbmdcbiAgYXN5bmMgcHJldmlld1Jlc29sdmVkQ29udGV4dChcbiAgICBwcm9qZWN0SWQ6IHN0cmluZyxcbiAgICBmZWF0dXJlQ29udGV4dDogSW5wdXRDb250ZXh0XG4gICk6IFByb21pc2U8e1xuICAgIHJlc29sdmVkOiBSZXNvbHZlZENvbnRleHRcbiAgICBpbmhlcml0ZWRfZnJvbV9wcm9qZWN0OiBQYXJ0aWFsPFJlc29sdmVkQ29udGV4dD5cbiAgICBmZWF0dXJlX292ZXJyaWRlczogUGFydGlhbDxSZXNvbHZlZENvbnRleHQ+XG4gIH0+IHtcbiAgICBjb25zdCBkYlNlcnZpY2UgPSBhd2FpdCBnZXREQlNlcnZpY2UoKVxuICAgIFxuICAgIGNvbnN0IGFjdGl2ZUNvbnRleHQgPSBhd2FpdCBkYlNlcnZpY2UuZ2V0QWN0aXZlUHJvamVjdENvbnRleHQocHJvamVjdElkKVxuICAgIGNvbnN0IHByb2plY3REZWZhdWx0cyA9IGFjdGl2ZUNvbnRleHQ/LmNvbnRleHRfanNvbiB8fCBERUZBVUxUX1BST0pFQ1RfQ09OVEVYVFxuICAgIFxuICAgIGNvbnN0IHJlc29sdmVkID0gYXdhaXQgdGhpcy5yZXNvbHZlQ29udGV4dChwcm9qZWN0SWQsIGZlYXR1cmVDb250ZXh0KVxuICAgIFxuICAgIC8vIENhbGN1bGF0ZSB3aGF0IGNhbWUgZnJvbSB3aGVyZSBmb3IgdHJhbnNwYXJlbmN5XG4gICAgY29uc3QgaW5oZXJpdGVkID0geyAuLi5wcm9qZWN0RGVmYXVsdHMgfVxuICAgIGNvbnN0IG92ZXJyaWRlcyA9IGZlYXR1cmVDb250ZXh0Lm92ZXJyaWRlcyB8fCB7fVxuICAgIFxuICAgIHJldHVybiB7XG4gICAgICByZXNvbHZlZCxcbiAgICAgIGluaGVyaXRlZF9mcm9tX3Byb2plY3Q6IGluaGVyaXRlZCxcbiAgICAgIGZlYXR1cmVfb3ZlcnJpZGVzOiBvdmVycmlkZXMsXG4gICAgfVxuICB9XG4gIFxuICAvLyBWYWxpZGF0ZSBjb250ZXh0IGNvbXBsZXRlbmVzc1xuICB2YWxpZGF0ZUNvbnRleHQoY29udGV4dDogUmVzb2x2ZWRDb250ZXh0KToge1xuICAgIGlzVmFsaWQ6IGJvb2xlYW5cbiAgICB3YXJuaW5nczogc3RyaW5nW11cbiAgICBzdWdnZXN0aW9uczogc3RyaW5nW11cbiAgfSB7XG4gICAgY29uc3Qgd2FybmluZ3M6IHN0cmluZ1tdID0gW11cbiAgICBjb25zdCBzdWdnZXN0aW9uczogc3RyaW5nW10gPSBbXVxuICAgIFxuICAgIC8vIENoZWNrIGZvciBjb21tb24gbWlzc2luZyBlbGVtZW50c1xuICAgIGlmIChPYmplY3Qua2V5cyhjb250ZXh0Lmdsb3NzYXJ5KS5sZW5ndGggPT09IDApIHtcbiAgICAgIHN1Z2dlc3Rpb25zLnB1c2goJ0NvbnNpZGVyIGFkZGluZyBkb21haW4gdGVybXMgdG8gdGhlIGdsb3NzYXJ5JylcbiAgICB9XG4gICAgXG4gICAgaWYgKGNvbnRleHQuc3Rha2Vob2xkZXJzLmxlbmd0aCA9PT0gMCkge1xuICAgICAgd2FybmluZ3MucHVzaCgnTm8gc3Rha2Vob2xkZXJzIGRlZmluZWQgLSB0aGlzIG1heSBsZWFkIHRvIHVuY2xlYXIgcmVxdWlyZW1lbnRzJylcbiAgICB9XG4gICAgXG4gICAgaWYgKGNvbnRleHQuY29uc3RyYWludHMubGVuZ3RoID09PSAwKSB7XG4gICAgICBzdWdnZXN0aW9ucy5wdXNoKCdDb25zaWRlciBhZGRpbmcgdGVjaG5pY2FsIG9yIGJ1c2luZXNzIGNvbnN0cmFpbnRzJylcbiAgICB9XG4gICAgXG4gICAgaWYgKGNvbnRleHQubm9uX2Z1bmN0aW9uYWwubGVuZ3RoID09PSAwKSB7XG4gICAgICBzdWdnZXN0aW9ucy5wdXNoKCdDb25zaWRlciBhZGRpbmcgbm9uLWZ1bmN0aW9uYWwgcmVxdWlyZW1lbnRzIChwZXJmb3JtYW5jZSwgc2VjdXJpdHksIGV0Yy4pJylcbiAgICB9XG4gICAgXG4gICAgaWYgKGNvbnRleHQuYXBpX2NhdGFsb2cubGVuZ3RoID09PSAwKSB7XG4gICAgICBzdWdnZXN0aW9ucy5wdXNoKCdDb25zaWRlciBkb2N1bWVudGluZyBleGlzdGluZyBBUElzIGFuZCBzZXJ2aWNlcycpXG4gICAgfVxuICAgIFxuICAgIC8vIENoZWNrIHN0YWtlaG9sZGVyIGNvbXBsZXRlbmVzc1xuICAgIGNvbnN0IGluY29tcGxldGVTdGFrZWhvbGRlcnMgPSBjb250ZXh0LnN0YWtlaG9sZGVycy5maWx0ZXIocyA9PiBcbiAgICAgICFzLnJvbGUgfHwgcy5pbnRlcmVzdHMubGVuZ3RoID09PSAwXG4gICAgKVxuICAgIGlmIChpbmNvbXBsZXRlU3Rha2Vob2xkZXJzLmxlbmd0aCA+IDApIHtcbiAgICAgIHdhcm5pbmdzLnB1c2goYCR7aW5jb21wbGV0ZVN0YWtlaG9sZGVycy5sZW5ndGh9IHN0YWtlaG9sZGVyKHMpIG1pc3Npbmcgcm9sZSBvciBpbnRlcmVzdHNgKVxuICAgIH1cbiAgICBcbiAgICBjb25zdCBpc1ZhbGlkID0gd2FybmluZ3MubGVuZ3RoID09PSAwXG4gICAgXG4gICAgcmV0dXJuIHsgaXNWYWxpZCwgd2FybmluZ3MsIHN1Z2dlc3Rpb25zIH1cbiAgfVxuICBcbiAgLy8gSW1wb3J0IGNvbnRleHQgZnJvbSBleHRlcm5hbCBzb3VyY2UgKEppcmEsIENvbmZsdWVuY2UsIGV0Yy4pXG4gIGFzeW5jIGltcG9ydENvbnRleHQoXG4gICAgcHJvamVjdElkOiBzdHJpbmcsXG4gICAgc291cmNlOiAnamlyYScgfCAnY29uZmx1ZW5jZScgfCAnanNvbicsXG4gICAgZGF0YTogYW55XG4gICk6IFByb21pc2U8UmVzb2x2ZWRDb250ZXh0PiB7XG4gICAgLy8gUGxhY2Vob2xkZXIgZm9yIGV4dGVybmFsIGludGVncmF0aW9uc1xuICAgIHN3aXRjaCAoc291cmNlKSB7XG4gICAgICBjYXNlICdqc29uJzpcbiAgICAgICAgLy8gVmFsaWRhdGUgYW5kIGltcG9ydCBKU09OIGNvbnRleHRcbiAgICAgICAgY29uc3QgaW1wb3J0ZWQgPSBkYXRhIGFzIFJlc29sdmVkQ29udGV4dFxuICAgICAgICByZXR1cm4gdGhpcy5jcmVhdGVQcm9qZWN0Q29udGV4dChwcm9qZWN0SWQsIGltcG9ydGVkLCBmYWxzZSkudGhlbihjID0+IGMuY29udGV4dF9qc29uKVxuICAgICAgXG4gICAgICBjYXNlICdqaXJhJzpcbiAgICAgICAgLy8gRXh0cmFjdCBjb250ZXh0IGZyb20gSmlyYSBwcm9qZWN0IG1ldGFkYXRhXG4gICAgICAgIC8vIFRoaXMgd291bGQgaW50ZWdyYXRlIHdpdGggSmlyYSBBUEkgdG8gZXh0cmFjdCBjb21wb25lbnRzLCB1c2VycywgZXRjLlxuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ0ppcmEgaW1wb3J0IG5vdCB5ZXQgaW1wbGVtZW50ZWQnKVxuICAgICAgXG4gICAgICBjYXNlICdjb25mbHVlbmNlJzpcbiAgICAgICAgLy8gRXh0cmFjdCBjb250ZXh0IGZyb20gQ29uZmx1ZW5jZSBzcGFjZVxuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ0NvbmZsdWVuY2UgaW1wb3J0IG5vdCB5ZXQgaW1wbGVtZW50ZWQnKVxuICAgICAgXG4gICAgICBkZWZhdWx0OlxuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYFVua25vd24gaW1wb3J0IHNvdXJjZTogJHtzb3VyY2V9YClcbiAgICB9XG4gIH1cbn1cblxuLy8gRGVmYXVsdCBzZXJ2aWNlIGluc3RhbmNlXG5leHBvcnQgY29uc3QgcHJvamVjdENvbnRleHRTZXJ2aWNlID0gbmV3IFByb2plY3RDb250ZXh0U2VydmljZSgpIl0sIm5hbWVzIjpbImdldERCU2VydmljZSIsImRlZXBNZXJnZSIsInRhcmdldCIsInNvdXJjZSIsInJlc3VsdCIsImtleSIsInVuZGVmaW5lZCIsIkFycmF5IiwiaXNBcnJheSIsImNhbGN1bGF0ZURpZmYiLCJwcmV2aW91cyIsImN1cnJlbnQiLCJkaWZmIiwiSlNPTiIsInN0cmluZ2lmeSIsIkRFRkFVTFRfUFJPSkVDVF9DT05URVhUIiwiZ2xvc3NhcnkiLCJzdGFrZWhvbGRlcnMiLCJjb25zdHJhaW50cyIsIm5vbl9mdW5jdGlvbmFsIiwiYXBpX2NhdGFsb2ciLCJkYXRhX21vZGVscyIsImVudnMiLCJsYWJlbHMiLCJQcm9qZWN0Q29udGV4dFNlcnZpY2UiLCJyZXNvbHZlQ29udGV4dCIsInByb2plY3RJZCIsImZlYXR1cmVDb250ZXh0IiwiZGJTZXJ2aWNlIiwiYWN0aXZlQ29udGV4dCIsImdldEFjdGl2ZVByb2plY3RDb250ZXh0IiwicHJvamVjdERlZmF1bHRzIiwiY29udGV4dF9qc29uIiwiaW5oZXJpdF9mcm9tX3Byb2plY3QiLCJyZXNvbHZlZENvbnRleHQiLCJsZW5ndGgiLCJleGlzdGluZ1N0YWtlaG9sZGVycyIsIm1hcCIsInMiLCJuYW1lIiwibmV3U3Rha2Vob2xkZXJOYW1lcyIsImZpbHRlciIsImluY2x1ZGVzIiwibmV3U3Rha2Vob2xkZXJzIiwicm9sZSIsImludGVyZXN0cyIsInVuaXF1ZUNvbnN0cmFpbnRzIiwiU2V0IiwiZnJvbSIsInVuaXF1ZU5vbkZ1bmN0aW9uYWwiLCJvdmVycmlkZXMiLCJjcmVhdGVQcm9qZWN0Q29udGV4dCIsImNvbnRleHQiLCJpc0FjdGl2ZSIsImV4aXN0aW5nQ29udGV4dHMiLCJnZXRQcm9qZWN0Q29udGV4dHMiLCJuZXh0VmVyc2lvbiIsIk1hdGgiLCJtYXgiLCJjIiwidmVyc2lvbiIsIm5ld0NvbnRleHQiLCJwcm9qZWN0X2lkIiwiaXNfYWN0aXZlIiwicHJldmlvdXNDb250ZXh0IiwiT2JqZWN0Iiwia2V5cyIsInVwZGF0ZVByb2plY3RDb250ZXh0IiwidXBkYXRlcyIsImNyZWF0ZU5ld1ZlcnNpb24iLCJFcnJvciIsInVwZGF0ZWRDb250ZXh0IiwidXBkYXRlUHJvamVjdCIsImlkIiwiZ2V0Q29udGV4dEhpc3RvcnkiLCJjb250ZXh0cyIsInNvcnQiLCJhIiwiYiIsImhpc3RvcnkiLCJpbmRleCIsImlzX2N1cnJlbnQiLCJhY3RpdmF0ZUNvbnRleHRWZXJzaW9uIiwiY29udGV4dElkIiwiYWN0aXZhdGVQcm9qZWN0Q29udGV4dCIsInByZXZpZXdSZXNvbHZlZENvbnRleHQiLCJyZXNvbHZlZCIsImluaGVyaXRlZCIsImluaGVyaXRlZF9mcm9tX3Byb2plY3QiLCJmZWF0dXJlX292ZXJyaWRlcyIsInZhbGlkYXRlQ29udGV4dCIsIndhcm5pbmdzIiwic3VnZ2VzdGlvbnMiLCJwdXNoIiwiaW5jb21wbGV0ZVN0YWtlaG9sZGVycyIsImlzVmFsaWQiLCJpbXBvcnRDb250ZXh0IiwiZGF0YSIsImltcG9ydGVkIiwidGhlbiIsInByb2plY3RDb250ZXh0U2VydmljZSJdLCJpZ25vcmVMaXN0IjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(ssr)/./src/lib/projectContext.ts\n");

/***/ })

};
;